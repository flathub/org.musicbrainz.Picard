{
    "id": "org.musicbrainz.Picard",
    "runtime": "org.kde.Platform",
    "runtime-version": "5.13",
    "sdk": "org.kde.Sdk",
    "command": "picard",
    "finish-args": [
        "--share=ipc",
        "--socket=x11",
        "--socket=wayland",
        "--socket=pulseaudio",
        "--share=network",
        "--device=all",
        "--filesystem=home",
        "--filesystem=xdg-music",
        "--filesystem=/tmp"
    ],
    "build-options": {
        "env": {
            "PYTHON": "/usr/bin/python3",
            "PIP": "/usr/bin/pip3"
        }
    },
    "modules": [
        {
            "name": "python-pyparsing",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "cleanup": [
                "*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/00/32/8076fa13e832bb4dcff379f18f228e5a53412be0631808b9ca2610c0f566/pyparsing-2.4.5.tar.gz",
                    "sha256": "4ca62001be367f01bd3e92ecbb79070272a9d4964dce6a48a82ff0b8bc7e683a"
                }
            ]
        },
        {
            "name": "python-packaging",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "cleanup": [
                "*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/5a/2f/449ded84226d0e2fda8da9252e5ee7731bdf14cd338f622dfcd9934e0377/packaging-19.2.tar.gz",
                    "sha256": "28b924174df7a2fa32c1953825ff29c61e2f5e082343165438812f00d3a7fc47"
                }
            ]
        },
        {
            "name": "python-toml",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "cleanup": [
                "*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/b9/19/5cbd78eac8b1783671c40e34bb0fa83133a06d340a38b55c645076d40094/toml-0.10.0.tar.gz",
                    "sha256": "229f81c57791a41d65e399fc06bf0848bab550a9dfd5ed66df18ce5f05e73d5c"
                }
            ]
        },
        {
            "name": "sip",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "cleanup": [
                "*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/da/04/65ff7595908c8e911057e4e9b3307bd7d54c7fd5698eb0ccc491df44003e/sip-5.0.1.tar.gz",
                    "sha256": "299f5463946acf079f35979bf6f598f790a58611ada2514c0d9b04c91b9baee8"
                }
            ]
        },
        {
            "name": "pyqt-sip",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/16/81/65f1c54ee545aef75e7ff760a5635f176d1528a1bf6d874bfe22bb2d283c/PyQt5_sip-12.7.0.tar.gz",
                    "sha256": "0a067ade558befe4d46335b13d8b602b5044363bfd601419b556d4ec659bca18"
                }
            ]
        },
        {
            "name": "pyqt-builder",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "cleanup": [
                "*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/a1/a0/d2e762c2e2542c5e05bb2f45bc4bef320f8d6fbe636ae61800d446c00cbc/PyQt-builder-1.1.0.tar.gz",
                    "sha256": "e8a809ad75e16a2e1439bd99c42e495d59b744ed5d47039f243cf7036e92457a"
                }
            ]
        },
        {
            "name": "pyqt",
            "buildsystem": "simple",
            "build-commands": [
                ". ${FLATPAK_BUILDER_BUILDDIR}/build"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/7c/5b/e760ec4f868cb77cee45b4554bf15d3fe6972176e89c4e3faac941213694/PyQt5-5.14.0.tar.gz",
                    "sha256": "0145a6b7de15756366decb736c349a0cb510d706c83fda5b8cd9e0557bc1da72"
                },
                {
                    "type": "file",
                    "path": "pyqt-build",
                    "dest-filename": "build"
                }
            ],
            "cleanup": [
                "/bin"
            ]
        },
        {
            "name": "ffmpeg",
            "config-opts": [
                "--enable-shared",
                "--disable-static",
                "--disable-doc",
                "--enable-gpl",
                "--enable-version3",
                "--disable-nonfree",
                "--enable-optimizations",
                "--enable-pthreads",

                "--disable-bzlib",
                "--disable-libgsm",
                "--enable-libvorbis",
                "--enable-zlib",
                "--disable-libxcb",
                "--disable-lzma",

                "--disable-programs",
                "--disable-network",

                "--disable-protocols",
                "--enable-protocol=file",

                "--disable-devices",

                "--disable-muxers",

                "--disable-demuxers",
                "--enable-demuxer=flac",
                "--enable-demuxer=mp3",
                "--enable-demuxer=ogg",

                "--disable-parsers",
                "--enable-parser=flac",
                "--enable-parser=vorbis",

                "--disable-encoders",

                "--disable-decoders",
                "--enable-decoder=flac",
                "--enable-decoder=libvorbis",
                "--enable-decoder=mp3"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.ffmpeg.org/releases/ffmpeg-3.4.7.tar.xz",
                    "sha256": "efd01782fd29b62505c973f5b61a65632d7b435dc9f4a6c97e92e6afd36cf5c8"
                }
            ],
            "cleanup": [
                "/lib/*.so",
                "/include",
                "/lib/pkgconfig",
                "/share/ffmpeg"
            ]
        },
        {
            "name": "chromaprint",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "config-opts": [
                "-DCMAKE_BUILD_TYPE:STRING=Release",
                "-DBUILD_TOOLS:BOOL=ON"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/acoustid/chromaprint/releases/download/v1.4.3/chromaprint-1.4.3.tar.gz",
                    "sha256": "ea18608b76fb88e0203b7d3e1833fb125ce9bb61efe22c6e169a50c52c457f82"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig"
            ]
        },
        {
            "name": "libdiscid",
            "config-opts": [
                "--disable-static"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://ftp.musicbrainz.org/pub/musicbrainz/libdiscid/libdiscid-0.6.2.tar.gz", /* No HTTPS */
                    "sha256": "f9e443ac4c0dd4819c2841fcc82169a46fb9a626352cdb9c7f65dd3624cd31b9"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig"
            ]
        },
        {
            "name": "python-discid",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/source/d/discid/discid-1.2.0.tar.gz",
                    "sha256": "cd9630bc53f5566df92819641040226e290b2047573f2c74a6e92b8eed9e86b9"
                }
            ]
        },
        {
            "name": "mutagen",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/source/m/mutagen/mutagen-1.43.0.tar.gz",
                    "sha256": "3a982d39f1b800520a32afdebe3543f972e83a6ddd0c0198739a161ee705b588"
                }
            ],
            "cleanup": [
                "/bin",
                "/share/man"
            ]
        },
        {
            "name": "bpm-plugin-dep-numpy",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/source/n/numpy/numpy-1.17.2.zip",
                    "sha256": "73615d3edc84dd7c4aeb212fa3748fb83217e00d201875a47327f55363cef2df"
                }
            ],
            "cleanup": [
                "/bin",
                "/lib/python3.*/site-packages/numpy/core/include",
                "/lib/python3.*/site-packages/numpy/core/lib/libnpymath.a",
                "/lib/python3.*/site-packages/numpy/tests",
                "/lib/python3.*/site-packages/numpy/*/tests"
            ]
        },
        {
            "name": "bpm-plugin-dep-aubio",
            "buildsystem": "simple",
            "build-commands": [
                "${PIP} install --no-deps --prefix=${FLATPAK_DEST} ."
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/source/a/aubio/aubio-0.4.9.tar.gz",
                    "sha256": "df1244f6c4cf5bea382c8c2d35aa43bc31f4cf631fe325ae3992c219546a4202"
                }
            ],
            "cleanup": [
                "/bin"
            ]
        },
        {
            "name": "picard",
            "buildsystem": "simple",
            "build-commands": [
                "${PYTHON} setup.py install --prefix=${FLATPAK_DEST} --disable-autoupdate"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/metabrainz/picard.git",
                    "tag": "release-2.3.0a1",
                    "commit": "aa372fbe4cc27e0a05705f4d0ae530c78f11c551"
                }
            ]
        }
    ]
}
